---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# MultimodalExperiment

<!-- badges: start -->
[![code quality](https://img.shields.io/codefactor/grade/github/schifferl/MultimodalExperiment)](https://www.codefactor.io/repository/github/schifferl/MultimodalExperiment)
<!-- badges: end -->

MultimodalExperiment is an S4 class that integrates bulk and single-cell experiment data; it is optimally storage-efficient, and its methods are exceptionally fast. It effortlessly represents multimodal data of any nature and features normalized experiment, subject, sample, and cell annotations, which are related to underlying biological experiments through maps. Its coordination methods are opt-in and employ database-like join operations internally to deliver fast and flexible management of multimodal data.

## Installation

You can install `r BiocStyle::Githubpkg("schifferl/MultimodalExperiment")` using `r BiocStyle::CRANpkg("BiocManager")` with:

```{r, eval = FALSE}
BiocManager::install("schifferl/MultimodalExperiment", dependencies = TRUE, build_vignettes = TRUE)
```

## Cheat Sheet

[![](MultimodalExperiment.png)](MultimodalExperiment.pdf)

## Usage

```{r, collapse = TRUE, message = FALSE, results = "hold"}
library(MultimodalExperiment)

ME <-
    MultimodalExperiment()

bulkExperiments(ME) <-
    ExperimentList(
        pbRNAseq = pbRNAseq
    )

singleCellExperiments(ME) <-
    ExperimentList(
        scADTseq = scADTseq,
        scRNAseq = scRNAseq
    )

subjectMap(ME)[["subject"]] <-
    "SUBJECT-1"

sampleMap(ME)[["subject"]] <-
    "SUBJECT-1"

cellMap(ME)[["sample"]] <-
    "SAMPLE-1"

ME <-
    propagate(ME)

experimentData(ME)[["published"]] <-
    c(NA_character_, "2018-11-19", "2018-11-19") |>
    as.Date()

subjectData(ME)[["condition"]] <-
    as.character("healthy")

sampleData(ME)[["sampleType"]] <-
    as.character("peripheral blood mononuclear cells")

cellType <- function(x) {
    if (x[["CD4"]] > 0L) {
        return("T Cell")
    }

    if (x[["CD14"]] > 0L) {
        return("Monocyte")
    }

    if (x[["CD19"]] > 0L) {
        return("B Cell")
    }

    if (x[["CD56"]] > 0L) {
        return("NK Cell")
    }

    NA_character_
}

cellData(ME)[["cellType"]] <-
    experiment(ME, "scADTseq") |>
    apply(2L, cellType)

ME


```

## Contributing

Please note that `r BiocStyle::Githubpkg("schifferl/MultimodalExperiment")` is released with a [code of conduct](CODE_OF_CONDUCT.md). By [contributing](CONTRIBUTING.md), you agree to abide by its terms.
